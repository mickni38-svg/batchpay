<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="BatchPay.OrdersPage"
             Title="Orders">

    <VerticalStackLayout Padding="10" Spacing="10">
        <Label Text="Orders"
               FontSize="28"
               FontAttributes="Bold"
               HorizontalOptions="Center"
               Margin="0,10,0,20" />
        <VerticalStackLayout Padding="20">
            <Button Text="Test API"
            Clicked="OnTestApiClicked"
            BackgroundColor="LightBlue"
            TextColor="Black"/>

            <CollectionView ItemsSource="{Binding Orders}">
                <!-- Din eksisterende liste -->
            </CollectionView>
        </VerticalStackLayout>

        
        <CollectionView ItemsSource="{Binding Orders}">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Margin="0,5"
                           Padding="10"
                           BorderColor="LightGray"
                           BackgroundColor="White"
                           CornerRadius="10"
                           HasShadow="True">
                        <VerticalStackLayout>
                            <!-- Accordion -->
                            <toolkit:Expander>
                                <toolkit:Expander.Header>
                                    <Grid Padding="5">
                                        <Label Text="{Binding Title}"
                                               FontSize="18"
                                               FontAttributes="Bold" />
                                        <Label Text="{Binding Status}"
                                               FontSize="14"
                                               TextColor="Gray"
                                               Grid.Row="1" />
                                    </Grid>
                                </toolkit:Expander.Header>

                                <!-- Accordion Content (Order Details) -->
                                <toolkit:Expander.Content>
                                    <VerticalStackLayout Padding="5">

                                        <Label Text="Order Lines"
                                               FontSize="16"
                                               FontAttributes="Bold" />

                                        <CollectionView ItemsSource="{Binding OrderLines}">
                                            <CollectionView.ItemTemplate>
                                                <DataTemplate>
                                                    <HorizontalStackLayout Spacing="10">
                                                        <Label Text="{Binding ItemName}" />
                                                        <Label Text="{Binding Quantity}" />
                                                        <Label Text="{Binding Price}" />
                                                    </HorizontalStackLayout>
                                                </DataTemplate>
                                            </CollectionView.ItemTemplate>
                                        </CollectionView>

                                        <Label Text="Participants"
                                               FontSize="16"
                                               FontAttributes="Bold"
                                               Margin="0,10,0,0" />

                                        <CollectionView ItemsSource="{Binding Participants}">
                                            <CollectionView.ItemTemplate>
                                                <DataTemplate>
                                                    <HorizontalStackLayout Spacing="10">
                                                        <Label Text="{Binding UserName}" />
                                                        <Label Text="{Binding HasPaid, StringFormat='Paid: {0}'}" />
                                                    </HorizontalStackLayout>
                                                </DataTemplate>
                                            </CollectionView.ItemTemplate>
                                        </CollectionView>

                                    </VerticalStackLayout>
                                </toolkit:Expander.Content>
                            </toolkit:Expander>
                        </VerticalStackLayout>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </VerticalStackLayout>
</ContentPage>
